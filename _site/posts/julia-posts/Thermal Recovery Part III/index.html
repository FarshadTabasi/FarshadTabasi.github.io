<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Farshad Tabasinejad">
<meta name="dcterms.date" content="2023-03-18">

<title>Entropy - Thermal Recovery - Part III</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon/entropy_ai.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/favicon/entropy_ai.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Entropy</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/FarshadTabasi"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mastodon.social/@farshadtabasinejad@fosstodon.org"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#disclaimer" id="toc-disclaimer" class="nav-link active" data-scroll-target="#disclaimer">Disclaimer</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#heat-conduction-ahead-of-an-advancing-front" id="toc-heat-conduction-ahead-of-an-advancing-front" class="nav-link" data-scroll-target="#heat-conduction-ahead-of-an-advancing-front">Heat conduction ahead of an advancing front</a>
  <ul class="collapse">
  <li><a href="#total-heat-stored-ahead-of-the-front-at-steady-state" id="toc-total-heat-stored-ahead-of-the-front-at-steady-state" class="nav-link" data-scroll-target="#total-heat-stored-ahead-of-the-front-at-steady-state">Total heat stored ahead of the front at steady state</a></li>
  <li><a href="#total-heat-stored-ahead-of-the-front-at-transient-state" id="toc-total-heat-stored-ahead-of-the-front-at-transient-state" class="nav-link" data-scroll-target="#total-heat-stored-ahead-of-the-front-at-transient-state">Total heat stored ahead of the front at transient state</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Thermal Recovery - Part III</h1>
<p class="subtitle lead">Heat Conduction Ahead of an Advancing Front</p>
  <div class="quarto-categories">
    <div class="quarto-category">julia</div>
    <div class="quarto-category">thermal recovery</div>
    <div class="quarto-category">heat conduction</div>
    <div class="quarto-category">heat loss</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Farshad Tabasinejad </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 18, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 18, 2021</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="disclaimer" class="level1">
<h1>Disclaimer</h1>
<p>This blog post is for educational purposes only. Any commercial use of the information provided in this blog post is prohibited. The author is not responsible for any damage or loss caused by the use of the information provided in this blog post.</p>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the previous post, we discussed heat conduction into the overburden from a stationary hot surface area. It was extended to a case with the hot source area exapnding over time parallel to the overburden surface. In this post, we will extend the model to include heat conduction ahead of an advancing front moving into the overburden. The model is based on the work of [1]. The problem is a 1D heat conduction model with a moving front. Details of the model can be found in [1]. The model is implemented in Julia and the source code can be downloaded by clicking on <strong><code>&lt;/&gt;Code</code></strong> next to the blog title.</p>
</section>
<section id="heat-conduction-ahead-of-an-advancing-front" class="level1">
<h1>Heat conduction ahead of an advancing front</h1>
<p>In a steam-assisted gravity drainage (SAGD) process, as the mixture of heated oil and condensate moves downward due to the gravity, the steam chamber expandes to fill in the voidage. A fraction of the stored heat in the chamber will be transfered ahead of the moving chamber into the cold region by conduction. The heat transfer ahead of the advancing front is modeled as a 1D heat conduction problem with a moving front.</p>
<p>The analytical solution for this problem is given by [1]:</p>
<p><span id="eq-1"><span class="math display">\[
\frac {\partial^{2} T^{*}}{\partial \zeta^{2}} + \frac {\partial T^{*}}{\partial \zeta} = \frac {\partial T^{*}}{\partial t^{*}}
\tag{1}\]</span></span></p>
<p>where <span class="math display">\[
T^{*} = \frac {T - T_{R}} {T_{s} - T_{R}}
\]</span></p>
<p><span class="math display">\[
t^{*} = \frac {U^{2}t} {\alpha}
\]</span></p>
<p><span class="math display">\[
\zeta^{*} = \frac {U \zeta} {U}
\]</span></p>
<p>U is the front velocity and <span class="math inline">\(\zeta\)</span> is the distance from the front and is defined as:</p>
<p><span class="math display">\[
\zeta = x - Ut
\]</span></p>
<p>The boundary conditions are:</p>
<p><span class="math display">\[
T^{*} = 0 \quad \text{when} \quad t = 0 \quad \text{for all} \quad \zeta^{*}
\]</span></p>
<p><span class="math display">\[
T^{*} = 1 \quad \text{when} \quad \zeta^{*} = 0 \quad \text{and} \quad \mathrm t \gt 0
\]</span></p>
<p>Solution of this problem is given by Carslaw and Jaeger [2]:</p>
<p><span class="math display">\[
T^{*} = \frac {1}{2} \left[\text{erfc} \left( \frac {\zeta^{*} + t^{*}}{\sqrt{4 \mathrm t^{*}}} \right) + e^{-\zeta^{*}} \text{erfc} \left( \frac {\zeta^{*} - t^{*}}{\sqrt{4 \mathrm t^{*}}} \right)    \right]
\]</span></p>
<p>where <span class="math inline">\(\text{erfc()}\)</span> is the complementary error function.</p>
<p>For the steady-state case, (<a href="#eq-1">Equation&nbsp;1</a>) will be simplified to:</p>
<p><span id="eq-2"><span class="math display">\[
\frac {\partial^{2} T^{*}}{\partial \zeta^{2}} + \frac {\partial T^{*}}{\partial \zeta} = 0
\tag{2}\]</span></span></p>
<p>The solution of this problem is given by Carslaw and Jaeger [2]:</p>
<p><span class="math display">\[
T^{*} = e^{-\zeta^{*}}
\]</span></p>
<p>We now implement both solutions in Julia:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SpecialFunctions</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ShiftedArrays</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Tstar_transient</span>(zeta_star, t_star)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.5</span> <span class="op">*</span> (<span class="fu">erfc</span>((zeta_star <span class="op">+</span> t_star) <span class="op">/</span> <span class="fu">sqrt</span>(<span class="fl">4</span> <span class="op">*</span> t_star)) <span class="op">+</span> <span class="fu">exp</span>(<span class="op">-</span>zeta_star) <span class="op">*</span> <span class="fu">erfc</span>((zeta_star <span class="op">-</span> t_star) <span class="op">/</span> <span class="fu">sqrt</span>(<span class="fl">4</span> <span class="op">*</span> t_star)))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Tstar_steady_state</span>(zeta_star)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">exp</span>(<span class="op">-</span>zeta_star)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The solution is plotted below for different values of <span class="math inline">\(t^{*}\)</span>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>zeta_star <span class="op">=</span> <span class="fu">range</span>(<span class="fl">0</span>, <span class="fl">5</span>, length <span class="op">=</span> <span class="fl">200</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>t_star <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">1.0</span>, <span class="fl">3.0</span>];</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot Tstar vs zeta_star for different values of t_star</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zeta_star, <span class="fu">Tstar_transient</span>.(zeta_star, t_star[<span class="fl">1</span>]), label <span class="op">=</span> <span class="st">"t* = </span><span class="sc">$</span>(t_star[<span class="fl">1</span>])<span class="st">"</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  legend <span class="op">=</span> <span class="op">:</span>topright, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  lw <span class="op">=</span> <span class="fl">2</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  title <span class="op">=</span> <span class="st">"Conductive temperature profile ahead of an advancing front"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu">length</span>(t_star)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot!</span>(zeta_star, <span class="fu">Tstar_transient</span>.(zeta_star, t_star[i]), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    lw <span class="op">=</span> <span class="fl">2</span>, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">"t* = </span><span class="sc">$</span>(t_star[i])<span class="st">"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(zeta_star, <span class="fu">Tstar_steady_state</span>.(zeta_star),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    lw <span class="op">=</span> <span class="fl">3</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">"steady state"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(L<span class="st">"\zeta^{*}"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(L<span class="st">"T^{*}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<p><img src="index_files/figure-html/cell-6-output-1.svg" class="img-fluid"></p>
</div>
</div>
<section id="total-heat-stored-ahead-of-the-front-at-steady-state" class="level2">
<h2 class="anchored" data-anchor-id="total-heat-stored-ahead-of-the-front-at-steady-state">Total heat stored ahead of the front at steady state</h2>
<p>The cumulative heat stored ahead of the advancing front at steady state is given by:</p>
<p><span class="math display">\[
\frac{Q_{c}}{A} = \kappa \frac {(T_{steam} - T_{reservoir})}{U}
\]</span></p>
<p>The following function is calculates the total heat stored ahead of the front at steady state:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">cumulative_heat_flux_stored_steady</span>(U, kappa, T_steam, T_reservoir)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kappa <span class="op">*</span> (T_steam <span class="op">-</span> T_reservoir) <span class="op">/</span> U</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="total-heat-stored-ahead-of-the-front-at-transient-state" class="level2">
<h2 class="anchored" data-anchor-id="total-heat-stored-ahead-of-the-front-at-transient-state">Total heat stored ahead of the front at transient state</h2>
<p>The total heat stored ahead of the front at transient state is given by:</p>
<p><span class="math display">\[
\frac{Q_{c}}{A} = \kappa \frac {(T_{steam} - T_{reservoir})}{U} \int_{0}^{\infty} T^{*} \mathrm d \zeta^{*}
\]</span></p>
<p>where <span class="math inline">\(T^{*}\)</span> is the temperature profile for the transient case. By substituting the solution for <span class="math inline">\(T^{*}\)</span>, the heat integral can be computed as follows:</p>
<p><span class="math display">\[
HI = \int_{0}^{\infty} T^{*} \mathrm d \zeta^{*} = \sqrt \frac{t^{*}}{\pi} e^{-t^{*}/4} + (1 + \frac{t^{*}}{2}) erf(\sqrt \frac {t^{*}}{4}) - \frac{t^{*}}{2}
\]</span></p>
<p>Figure below shows the behavior of heat integral with respect to <span class="math inline">\(t^{*}\)</span>. At infinity the value of heat integral is equal to the steady state value (<span class="math inline">\(HI_{\infty} = 1.0\)</span>).</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>t_star <span class="op">=</span> <span class="fu">range</span>(<span class="fl">0</span>, <span class="fl">25</span>, length <span class="op">=</span> <span class="fl">1000</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_star, <span class="fu">sqrt</span>.(t_star <span class="op">/</span> <span class="cn">pi</span>) <span class="op">.*</span> <span class="fu">exp</span>.(<span class="op">-</span>t_star <span class="op">/</span> <span class="fl">4</span>) <span class="op">.+</span> (<span class="fl">1</span> <span class="op">.+</span> t_star <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> <span class="fu">erf</span>.(<span class="fu">sqrt</span>.(t_star <span class="op">/</span> <span class="fl">4</span>)) <span class="op">.-</span> t_star <span class="op">/</span> <span class="fl">2</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    lw <span class="op">=</span> <span class="fl">3</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">"Heat Integral"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(L<span class="st">"t^{*}"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"Heat Integral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<p><img src="index_files/figure-html/cell-9-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>The total heat stored ahead of the front at transient state is calculated as follows:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make it broadcastable over t_star</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">cumulative_heat_flux_stored_transient</span>(U, kappa, T_steam, T_reservoir, t_star)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kappa <span class="op">*</span> (T_steam <span class="op">-</span> T_reservoir) <span class="op">/</span> U <span class="op">*</span> (<span class="fu">sqrt</span>.(t_star <span class="op">/</span> <span class="cn">pi</span>) <span class="op">.*</span> <span class="fu">exp</span>.(<span class="op">-</span>t_star <span class="op">/</span> <span class="fl">4</span>) <span class="op">.+</span> (<span class="fl">1</span> <span class="op">.+</span> t_star <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> <span class="fu">erf</span>.(<span class="fu">sqrt</span>.(t_star <span class="op">/</span> <span class="fl">4</span>)) <span class="op">.-</span> t_star <span class="op">/</span> <span class="fl">2</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>Following the example in previous post and by assuming that the steam chamber spread rapidly over the reservoir (constant surface area), we calculate the total heat stored ahead of the front at transient state for the following parameters:</p>
<ul>
<li><span class="math inline">\(U = 1.5 \mathrm m/365 \quad days\)</span></li>
<li><span class="math inline">\(\alpha = 8.333e-7 * 86400 \quad \mathrm m^{2}/day\)</span></li>
<li><span class="math inline">\(\kappa = 1.7 * 86400 \quad \mathrm J/day/m/K\)</span></li>
<li><span class="math inline">\(T_{steam} = 264 \quad ^{\circ}C\)</span></li>
<li><span class="math inline">\(T_{reservoir} = 15 \quad ^{\circ}C\)</span></li>
<li><span class="math inline">\(A = 40000 \quad \mathrm m^{2}\)</span></li>
</ul>
<p>It is assumed that the steam chamber moves downward at a speed of 1.5 m/year.</p>
<p>The annual total heat stored ahead of the front at transient state in 10 years is calculated as follows:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fu">range</span>(<span class="fl">0</span>, <span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span>) <span class="op">*</span> <span class="fl">1.0</span> <span class="co"># days</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> <span class="fl">1.5</span> <span class="op">/</span> <span class="fl">365</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>α <span class="op">=</span> <span class="fl">8.333e-7</span> <span class="op">*</span> <span class="fl">86400</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>t_star <span class="op">=</span> U <span class="op">*</span> U <span class="op">.*</span> t <span class="op">/</span> α</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> <span class="fl">1.7</span> <span class="op">*</span> <span class="fl">86400</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>T_steam <span class="op">=</span> <span class="fl">264</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>T_reservoir <span class="op">=</span> <span class="fl">15</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fl">40000</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the cumulative heat stored ahead of the front in overburden in MJoules</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> A <span class="op">*</span> <span class="fu">cumulative_heat_flux_stored_transient</span>(U, kappa, T_steam, T_reservoir, t_star) <span class="op">/</span> <span class="fl">1e6</span> <span class="co"># MJ</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create a DataFrame to store the results</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(t <span class="op">=</span> t, year <span class="op">=</span> t <span class="op">/</span> <span class="fl">365.0</span>, Q <span class="op">=</span> Q);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The annual cumulative heat stored ahead of the front at transient state in 10 years is calculated as follows:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_sub <span class="op">=</span> df[df.year <span class="op">.==</span> <span class="fu">round</span>.(df.year, digits <span class="op">=</span> <span class="fl">0</span>), <span class="op">:</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a lag column from Q column</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_sub[!, <span class="op">:</span>Q_lag] <span class="op">=</span> ShiftedArrays.<span class="fu">lag</span>(df_sub.Q, <span class="fl">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the increamental heat loss to overburden</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df_sub[!, <span class="op">:</span>Q_incremental] <span class="op">=</span> df_sub.Q <span class="op">-</span> df_sub.Q_lag</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@df</span> df_sub <span class="fu">bar</span>(<span class="op">:</span>year, <span class="op">:</span>Q_incremental, xlabel <span class="op">=</span> <span class="st">"Time (Year)"</span>, ylabel <span class="op">=</span> <span class="st">"Annual heat stored ahead of the front (MJoules)"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">"Annual Cumulative Heat Stored Ahead of the Front"</span>, lw <span class="op">=</span> <span class="fl">3</span>, label <span class="op">=</span> L<span class="st">"A = 40000 m^{2}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<p><img src="index_files/figure-html/cell-12-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this post, we showed that the maximum accumulated heat ahead of a moving front is equal to the steady state value. In many practical cases, the energy accumulation ahead of the steam front is close to the steady state value.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>