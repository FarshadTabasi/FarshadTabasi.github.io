<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Farshad Tabasinejad">
<meta name="dcterms.date" content="2023-03-04">

<title>Entropy - Alberta In-situ Oilsands Production Analysis using Python - Part II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon/entropy_ai.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/favicon/entropy_ai.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Entropy</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/FarshadTabasi"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mastodon.social/@farshadtabasinejad@fosstodon.org"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#disclaimer" id="toc-disclaimer" class="nav-link active" data-scroll-target="#disclaimer">Disclaimer</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data">Loading the Data</a></li>
  <li><a href="#analyzing-the-2010-bitumen-production-data" id="toc-analyzing-the-2010-bitumen-production-data" class="nav-link" data-scroll-target="#analyzing-the-2010-bitumen-production-data">Analyzing the 2010 bitumen production data</a>
  <ul class="collapse">
  <li><a href="#reading-the-first-file" id="toc-reading-the-first-file" class="nav-link" data-scroll-target="#reading-the-first-file">Reading the first file</a></li>
  <li><a href="#reading-the-bitumen-sheet" id="toc-reading-the-bitumen-sheet" class="nav-link" data-scroll-target="#reading-the-bitumen-sheet">Reading the BITUMEN sheet</a></li>
  <li><a href="#cleaning-the-operator-column" id="toc-cleaning-the-operator-column" class="nav-link" data-scroll-target="#cleaning-the-operator-column">Cleaning the Operator column</a></li>
  <li><a href="#simplifiying-the-area-column" id="toc-simplifiying-the-area-column" class="nav-link" data-scroll-target="#simplifiying-the-area-column">Simplifiying the Area column</a></li>
  </ul></li>
  <li><a href="#creating-a-single-tidy-dataset-for-bitumen-production-for-all-years" id="toc-creating-a-single-tidy-dataset-for-bitumen-production-for-all-years" class="nav-link" data-scroll-target="#creating-a-single-tidy-dataset-for-bitumen-production-for-all-years">Creating a single tidy dataset for bitumen production for all years</a></li>
  <li><a href="#saving-the-dataset" id="toc-saving-the-dataset" class="nav-link" data-scroll-target="#saving-the-dataset">Saving the dataset</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Alberta In-situ Oilsands Production Analysis using Python - Part II</h1>
<p class="subtitle lead">Preparing a tidy dataset for data analysis and visualization</p>
  <div class="quarto-categories">
    <div class="quarto-category">python</div>
    <div class="quarto-category">pandas</div>
    <div class="quarto-category">data analysis</div>
    <div class="quarto-category">data visualization</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Farshad Tabasinejad </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 4, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="disclaimer" class="level1">
<h1>Disclaimer</h1>
<p>This blog post is for educational purposes only. Any commercial use of the information provided in this blog post is prohibited. For more information about the AER copyright and permission to reproduce, please visit <a href="https://www.aer.ca/copyright-disclaimer">AER Copyright and Disclaimer</a>. The author is not responsible for any damage or loss caused by the use of the information provided in this blog post.</p>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This blog post focuses on analyzing the bitumen production data from in-situ oilsands projects in Alberta. Alberta Energy Regulator (AER) lists the monthly injection and production data for all in-situ oilsands projects in Alberta on its website <a href="https://www.aer.ca/">Alberta Energy Regulator</a>. The data is available in several spreadsheets and can be downloaded from <a href="https://www.aer.ca/providing-information/data-and-reports/statistical-reports/st53">ST53: Alberta In Situ Oil Sands Production Summary</a>. The annual data are reported in separate files in .xls format. Each file has 6 different sheets with the following information: bitumen production, water usage, steam injection, well count, steam-to-oil ratio (SOR), and water-to-oil ratio (WSR).</p>
<p>In the previous post <a href="">Downloading Alberta Oilsands Production Data using Python</a>, I have shown how to download the data using python. In this post we create a tidy bitumen dataset for data analysis and visualization.</p>
</section>
<section id="loading-the-data" class="level1">
<h1>Loading the Data</h1>
<p>All files are stored in the current local directory. We use the <code>glob</code> module to list all <code>.xls</code> files in the directory and then use <code>pandas</code> to read the data into a <code>DataFrame</code>. The <code>xlrd</code> is used as an engine in pandas to read the <code>.xls</code> files. The <code>numpy</code> module is used to perform mathematical operations on the data. The <code>warnings</code> module is used to suppress the warnings.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xlrd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>glob</code> module is used in this code to create a list of file paths for all the .xls files in the current directory.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>xls_files <span class="op">=</span> glob.glob(<span class="st">'*.xls'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>xls_files</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>['ST53_2010-12.xls',
 'ST53_2011-12.xls',
 'ST53_2012-12.xls',
 'ST53_2013-12.xls',
 'ST53_2014-12.xls',
 'ST53_2016-12.xls',
 'ST53_2017-12.xls',
 'ST53_2018-12.xls',
 'ST53_2019-12.xls',
 'ST53_2020-12.xls',
 'ST53_2021-12.xls',
 'ST53_2022-12.xls']</code></pre>
</div>
</div>
</section>
<section id="analyzing-the-2010-bitumen-production-data" class="level1">
<h1>Analyzing the 2010 bitumen production data</h1>
<p>This section describes the steps for creating a tidy dataset for bitumen production using the 2010 data.</p>
<section id="reading-the-first-file" class="level2">
<h2 class="anchored" data-anchor-id="reading-the-first-file">Reading the first file</h2>
<p>To start, we read the data from the <code>ST53_2010.xls</code> file using the <code>read_excel</code> function from the pandas library. We set the <code>sheet_name</code> argument to <code>None</code> to read all the sheets in the file. We also use the <code>skiprows</code> argument to skip the first three rows of each sheet. Finally, we use the <code>keys()</code> method to print the names of the sheets in the file.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sheets <span class="op">=</span> pd.read_excel(xls_files[<span class="dv">0</span>], sheet_name <span class="op">=</span> <span class="va">None</span>, skiprows <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'sheet names: </span><span class="sc">{</span>sheets<span class="sc">.</span>keys()<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sheet names: dict_keys(['BITUMEN', 'WATER', 'STEAM', 'WELLS', 'SOR', 'WSR'])</code></pre>
</div>
</div>
</section>
<section id="reading-the-bitumen-sheet" class="level2">
<h2 class="anchored" data-anchor-id="reading-the-bitumen-sheet">Reading the BITUMEN sheet</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the BITUMEN sheet</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>bitumen_2010 <span class="op">=</span> sheets[<span class="st">'BITUMEN'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>info</code> method is used to print the column names and data types of each column in the DataFrame.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 177 entries, 0 to 176
Data columns (total 18 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   Operator         172 non-null    object 
 1   Scheme Name      26 non-null     object 
 2   Area             163 non-null    object 
 3   Approval Number  163 non-null    object 
 4   Recovery Method  164 non-null    object 
 5   Jan              166 non-null    float64
 6   Feb              166 non-null    float64
 7   Mar              166 non-null    float64
 8   Apr              165 non-null    float64
 9   May              165 non-null    float64
 10  Jun              162 non-null    float64
 11  Jul              162 non-null    float64
 12  Aug              162 non-null    float64
 13  Sep              161 non-null    float64
 14  Oct              159 non-null    float64
 15  Nov              159 non-null    float64
 16  Dec              156 non-null    float64
 17  Monthly Average  153 non-null    float64
dtypes: float64(13), object(5)
memory usage: 25.0+ KB</code></pre>
</div>
</div>
<p>The <code>head</code> method is used to display the first 5 rows of the <code>DataFrame</code>.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Operator</th>
      <th>Scheme Name</th>
      <th>Area</th>
      <th>Approval Number</th>
      <th>Recovery Method</th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Monthly Average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Canadian Natural Resources Limited</td>
      <td>NaN</td>
      <td>Cold Lake</td>
      <td>4746P</td>
      <td>Commercial</td>
      <td>587.48</td>
      <td>596.72</td>
      <td>637.59</td>
      <td>678.74</td>
      <td>705.61</td>
      <td>718.99</td>
      <td>697.25</td>
      <td>696.88</td>
      <td>763.21</td>
      <td>702.21</td>
      <td>696.32</td>
      <td>674.99</td>
      <td>679.67</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Canadian Natural Resources Limited</td>
      <td>NaN</td>
      <td>Cold Lake</td>
      <td>6726I</td>
      <td>Commercial</td>
      <td>171.54</td>
      <td>193.66</td>
      <td>187.71</td>
      <td>177.54</td>
      <td>176.90</td>
      <td>174.50</td>
      <td>160.53</td>
      <td>155.97</td>
      <td>168.22</td>
      <td>168.27</td>
      <td>139.73</td>
      <td>143.48</td>
      <td>168.17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Baytex Energy Ltd. (¹)</td>
      <td>Cliffdale Pilot</td>
      <td>Peace River Area 2</td>
      <td>11034E</td>
      <td>Commercial-CSS</td>
      <td>0.00</td>
      <td>2.55</td>
      <td>6.15</td>
      <td>2.25</td>
      <td>4.16</td>
      <td>10.59</td>
      <td>5.83</td>
      <td>3.27</td>
      <td>9.18</td>
      <td>20.09</td>
      <td>15.42</td>
      <td>13.15</td>
      <td>8.42</td>
    </tr>
    <tr>
      <th>3</th>
      <td>North Peace Energy Corp.</td>
      <td>Red Earth</td>
      <td>Peace River Area 2</td>
      <td>11209A</td>
      <td>Commercial-CSS</td>
      <td>10.30</td>
      <td>4.70</td>
      <td>3.11</td>
      <td>2.21</td>
      <td>1.63</td>
      <td>0.51</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.40</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Penn West Petroleum Ltd.</td>
      <td>Seal</td>
      <td>Peace River Area 2</td>
      <td>11377A</td>
      <td>Commercial-CSS</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The <code>tail</code> method is used to print the last 20 rows of the <code>DataFrame</code>.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010.tail(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Operator</th>
      <th>Scheme Name</th>
      <th>Area</th>
      <th>Approval Number</th>
      <th>Recovery Method</th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
      <th>Monthly Average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>157</th>
      <td>Bronco Energy Ltd.</td>
      <td>NaN</td>
      <td>Athabasca</td>
      <td>9774E</td>
      <td>Primary</td>
      <td>28.65</td>
      <td>28.58</td>
      <td>27.94</td>
      <td>22.84</td>
      <td>91.39</td>
      <td>80.23</td>
      <td>77.59</td>
      <td>83.21</td>
      <td>64.28</td>
      <td>74.45</td>
      <td>69.66</td>
      <td>63.98</td>
      <td>59.40</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Devon Canada Corporation</td>
      <td>NaN</td>
      <td>Cold Lake</td>
      <td>9821</td>
      <td>Primary</td>
      <td>4.00</td>
      <td>3.41</td>
      <td>3.42</td>
      <td>0.00</td>
      <td>1.87</td>
      <td>0.00</td>
      <td>1.74</td>
      <td>1.04</td>
      <td>4.18</td>
      <td>4.09</td>
      <td>1.94</td>
      <td>2.76</td>
      <td>2.85</td>
    </tr>
    <tr>
      <th>159</th>
      <td>Frog Lake Energy Resources Corp.</td>
      <td>NaN</td>
      <td>Cold Lake</td>
      <td>9827B</td>
      <td>Primary</td>
      <td>11.42</td>
      <td>5.22</td>
      <td>5.11</td>
      <td>8.76</td>
      <td>12.08</td>
      <td>16.21</td>
      <td>13.78</td>
      <td>11.12</td>
      <td>17.36</td>
      <td>18.75</td>
      <td>19.41</td>
      <td>22.18</td>
      <td>13.45</td>
    </tr>
    <tr>
      <th>160</th>
      <td>Husky Oil Operations Limited</td>
      <td>NaN</td>
      <td>Cold Lake</td>
      <td>9873</td>
      <td>Primary</td>
      <td>12.32</td>
      <td>12.80</td>
      <td>12.66</td>
      <td>11.27</td>
      <td>12.93</td>
      <td>11.56</td>
      <td>11.63</td>
      <td>11.27</td>
      <td>10.62</td>
      <td>10.79</td>
      <td>11.50</td>
      <td>10.50</td>
      <td>11.65</td>
    </tr>
    <tr>
      <th>161</th>
      <td>Canadian Natural Resources Limited</td>
      <td>NaN</td>
      <td>Athabasca</td>
      <td>9884D</td>
      <td>Primary</td>
      <td>65.64</td>
      <td>68.55</td>
      <td>69.79</td>
      <td>64.72</td>
      <td>68.09</td>
      <td>64.18</td>
      <td>63.37</td>
      <td>66.10</td>
      <td>64.25</td>
      <td>62.55</td>
      <td>59.87</td>
      <td>55.29</td>
      <td>64.37</td>
    </tr>
    <tr>
      <th>162</th>
      <td>Koch Exploration Canada G/P Ltd. (¹)</td>
      <td>NaN</td>
      <td>Cold Lake</td>
      <td>9908D</td>
      <td>Primary</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>163</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total</td>
      <td>109423.83</td>
      <td>116311.68</td>
      <td>120054.09</td>
      <td>116601.43</td>
      <td>121671.30</td>
      <td>122439.61</td>
      <td>122234.75</td>
      <td>121215.19</td>
      <td>108260.73</td>
      <td>118808.23</td>
      <td>128196.96</td>
      <td>129913.57</td>
      <td>119594.28</td>
    </tr>
    <tr>
      <th>164</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>165</th>
      <td>Conventional Bitumen Recovery</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>537.49</td>
      <td>544.67</td>
      <td>560.36</td>
      <td>541.87</td>
      <td>560.71</td>
      <td>524.96</td>
      <td>482.84</td>
      <td>555.27</td>
      <td>555.21</td>
      <td>545.33</td>
      <td>601.13</td>
      <td>593.86</td>
      <td>550.31</td>
    </tr>
    <tr>
      <th>166</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Total</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>109961.32</td>
      <td>116856.35</td>
      <td>120614.45</td>
      <td>117143.30</td>
      <td>122232.01</td>
      <td>122964.57</td>
      <td>122717.59</td>
      <td>121770.46</td>
      <td>108815.94</td>
      <td>119353.56</td>
      <td>128798.09</td>
      <td>130507.43</td>
      <td>120144.59</td>
    </tr>
    <tr>
      <th>168</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>169</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>170</th>
      <td>Notes:</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>171</th>
      <td>- Monthly production totals may be revised due...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>172</th>
      <td>- Total may not add due to rounding</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>173</th>
      <td>- Conventional Bitumen production consists of ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>174</th>
      <td>- Monthly average does not include months ther...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>175</th>
      <td>¹ Amended this month</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>176</th>
      <td>¹ Amended this month</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Since the number of producers in the file can vary, we cannot rely on a fixed index number to subset the dataset. However, the last row of the dataset always contains a summary of the total production, which is identified by the cell value of <strong>Total</strong> in the <code>Recovery Method</code> column. Therefore, we can use the index number of the row with <strong>Total</strong> in the Recovery Method column to subset the dataset and exclude the summary row and any other rows with additional information.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the index of the last row using np.where</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>last_row_idx <span class="op">=</span> np.where(bitumen_2010[[<span class="st">"Recovery Method"</span>]] <span class="op">==</span> <span class="st">"Total "</span>)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>bitumen_2010 <span class="op">=</span> bitumen_2010.iloc[:last_row_idx, :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In addition, we can remove the <code>Monthly Average</code> column from the dataset since we will be aggregating the data in our analysis and therefore do not need the monthly averages.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010 <span class="op">=</span> bitumen_2010.drop(columns <span class="op">=</span> [<span class="st">'Monthly Average'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cleaning-the-operator-column" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-operator-column">Cleaning the Operator column</h2>
<p>Let’s take a look at the <code>Operator</code> column.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Operator'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array(['Canadian Natural Resources Limited', 'Baytex Energy Ltd. (¹)',
       'North Peace Energy Corp.', 'Penn West Petroleum Ltd.',
       'Baytex Energy Ltd. (¹²)', 'Shell Canada Limited',
       'Imperial Oil Resources (¹)',
       'Canadian Natural Resources Limited (¹)',
       'Devon NEC Corporation (¹)', 'Connacher Oil And Gas Limited',
       'Meg Energy Corp.', 'Statoil Canada Ltd. (¹)',
       'Cenovus Energy Inc.', 'Cenovus FCCL Ltd.', 'Suncor Energy Inc.',
       'Japan Canada Oil Sands Limited (¹)', 'Suncor Energy Inc. (¹)',
       'Total E&amp;P Joslyn Ltd. (¹)',
       'ConocoPhillips Canada Resources Corp.',
       'ConocoPhillips Canada Limited', 'Nexen Inc.',
       'Husky Oil Operations Limited', 'Canadian Natural Resources',
       'Murphy Oil Company Ltd.', 'Cenovus Energy Inc. (¹)',
       'Prosper Petroleum Ltd.', 'Penn West Energy Trust',
       'Baytex Energy Ltd.', 'Shell Canada Energy',
       'Husky Oil Operations Ltd.', 'Action Energy Inc.',
       'Devon Canada Corporation', 'Bonavista Petroleum Ltd.',
       'Murphy Oil Canada', 'Watch Resources Ltd.',
       'Manitok Exploration Inc.', 'Koch Exploration Canada G/P Ltd.',
       'Husky Oil Operations Limited (et Al)', 'Twin Butte Energy Ltd.',
       'Sunshine Oilsands Ltd.', 'Solara Exploration Ltd.',
       'Canadian Natural Resources Limited (¹²)',
       'Bellatrix Exploration Ltd. (¹²)', 'Blackpearl Resources Inc. (¹)',
       'Crispin Energy Inc.', 'Husky Oil Operations Limited (¹)',
       'Buffalo Resources Corp.', 'ExxonMobil Canada Ltd.',
       'Harvest Operations Corp.', 'Bronco Energy Ltd.',
       'Frog Lake Energy Resources Corp.',
       'Koch Exploration Canada G/P Ltd. (¹)'], dtype=object)</code></pre>
</div>
</div>
<p>The Operator column contains several names that are followed by <code>(subscripts)</code>. These additional pieces of information create inconsistencies in the <code>Operator</code> column and add unnecessary complexity to the dataset. Since they are not needed for our analysis, we can remove them using the <code>replace</code> method.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Operator'</span>] <span class="op">=</span> bitumen_2010[<span class="st">'Operator'</span>].<span class="bu">str</span>.replace(<span class="vs">r'\(.*\)'</span>, <span class="st">''</span>).<span class="bu">str</span>.strip()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Operator'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array(['Canadian Natural Resources Limited', 'Baytex Energy Ltd.',
       'North Peace Energy Corp.', 'Penn West Petroleum Ltd.',
       'Shell Canada Limited', 'Imperial Oil Resources',
       'Devon NEC Corporation', 'Connacher Oil And Gas Limited',
       'Meg Energy Corp.', 'Statoil Canada Ltd.', 'Cenovus Energy Inc.',
       'Cenovus FCCL Ltd.', 'Suncor Energy Inc.',
       'Japan Canada Oil Sands Limited', 'Total E&amp;P Joslyn Ltd.',
       'ConocoPhillips Canada Resources Corp.',
       'ConocoPhillips Canada Limited', 'Nexen Inc.',
       'Husky Oil Operations Limited', 'Canadian Natural Resources',
       'Murphy Oil Company Ltd.', 'Prosper Petroleum Ltd.',
       'Penn West Energy Trust', 'Shell Canada Energy',
       'Husky Oil Operations Ltd.', 'Action Energy Inc.',
       'Devon Canada Corporation', 'Bonavista Petroleum Ltd.',
       'Murphy Oil Canada', 'Watch Resources Ltd.',
       'Manitok Exploration Inc.', 'Koch Exploration Canada G/P Ltd.',
       'Twin Butte Energy Ltd.', 'Sunshine Oilsands Ltd.',
       'Solara Exploration Ltd.', 'Bellatrix Exploration Ltd.',
       'Blackpearl Resources Inc.', 'Crispin Energy Inc.',
       'Buffalo Resources Corp.', 'ExxonMobil Canada Ltd.',
       'Harvest Operations Corp.', 'Bronco Energy Ltd.',
       'Frog Lake Energy Resources Corp.'], dtype=object)</code></pre>
</div>
</div>
<p>The operator names in the dataset may contain inconsistencies where some operators are listed with different names. To make the names consistent, we can create a dictionary with the names to be replaced and the new names. However, it’s important to note that the following dictionary may contain additional names that are not in the 2010 dataset. This dictionary was created using data from all the files between 2010 and 2022.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dictionary to make Operator names consistent</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>operators_dict <span class="op">=</span> {<span class="st">'Athabasca Oil Corporation'</span>: <span class="st">'Athabasca Oil'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Baytex Energy Ltd.'</span>: <span class="st">'Baytex'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Blackpearl Resources Inc.'</span>: <span class="st">'BlackPearl'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'BlackPearl Resources Inc.'</span>: <span class="st">'BlackPearl'</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Bonavista Petroleum Ltd.'</span>: <span class="st">'Bonavista'</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Bonavista Energy Corporation'</span>: <span class="st">'Bonavista'</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'CNOOC Petroleum North America ULC'</span>: <span class="st">'CNOOC'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Canadian Natural Resources'</span>: <span class="st">'CNRL'</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Canadian Natural Resources Limited'</span>: <span class="st">'CNRL'</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Canadian Natural Upgrading Limited'</span>: <span class="st">'CNRL'</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Cenovus Energy Inc.'</span>: <span class="st">'Cenovus'</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Cenovus FCCL Ltd.'</span>: <span class="st">'Cenovus'</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'ConocoPhillips Canada Resources Corp.'</span>: <span class="st">'ConocoPhillips'</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'ConocoPhillips Canada Limited'</span>: <span class="st">'ConocoPhillips'</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Devon Canada Corporation'</span>: <span class="st">'Devon'</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Devon NEC Corporation'</span>: <span class="st">'Devon'</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'ExxonMobil Canada Ltd.'</span>: <span class="st">'Imperial'</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Greenfire Hangingstone Operating Corporation'</span>: <span class="st">'Greenfire'</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Greenfire Resources Operating Corporation'</span>: <span class="st">'Greenfire'</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Husky Oil Operations Limited'</span> : <span class="st">'Husky'</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Husky Oil Operations Ltd.'</span> : <span class="st">'Husky'</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Imperial Oil Resources'</span>: <span class="st">'Imperial'</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Imperial Oil Resources Limited'</span>: <span class="st">'Imperial'</span>,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Islander Oil &amp; Gas Inc.'</span>: <span class="st">'Islander'</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Koch Exploration Canada G/P Ltd.'</span>: <span class="st">'Koch'</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Koch Oil Sands Operating ULC'</span>: <span class="st">'Koch'</span>,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'MEG Energy Corp.'</span>: <span class="st">'MEG'</span>,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Meg Energy Corp.'</span>: <span class="st">'MEG'</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Murphy Oil Canada'</span>: <span class="st">'Murphy'</span>,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Murphy Oil Company Ltd.'</span>: <span class="st">'Murphy'</span>,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Nexen Energy ULC'</span>: <span class="st">'Nexen'</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Nexen Inc.'</span>: <span class="st">'Nexen'</span>,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Obsidian Energy Ltd.'</span>: <span class="st">'Obsidian'</span>,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'OSUM Oil Sands Corp.'</span>: <span class="st">'OSUM'</span>,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Osum Production Corp.'</span>: <span class="st">'OSUM'</span>,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Pengrowth Corporation'</span>: <span class="st">'Pengrowth'</span>,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Pengrowth Energy Corporation'</span>: <span class="st">'Pengrowth'</span>,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Penn West Energy Trust'</span>: <span class="st">'Penn West'</span>,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Penn West Petroleum Ltd.'</span>: <span class="st">'Penn West'</span>,</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Perpetual Energy Inc.'</span>: <span class="st">'Perpetual'</span>,</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Perpetual Energy Operating Corp.'</span>: <span class="st">'Perpetual'</span>,</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Perpetual Operating Corp.'</span>: <span class="st">'Perpetual'</span>,</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'PetroChina Canada Ltd.'</span>: <span class="st">'PetroChina'</span>,</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Petrochina Canada Ltd.'</span>: <span class="st">'PetroChina'</span>,</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Strathcona Resources Ltd.'</span>: <span class="st">'Strathcona'</span>,</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Shell Canada Energy'</span>: <span class="st">'Shell'</span>,</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Shell Canada Limited'</span>: <span class="st">'Shell'</span>,</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Spur Petroleum Ltd.'</span>: <span class="st">'Spur'</span>,</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Spur Resources Ltd.'</span>: <span class="st">'Spur'</span>,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Suncor Energy Inc.'</span>: <span class="st">'Suncor'</span>,</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Woodcote Oil &amp; Gas Inc.'</span>: <span class="st">'Woodcote'</span>,</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Woodcote Oil Corp.'</span>: <span class="st">'Woodcote'</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>                  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace the names in the Operator column</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Operator'</span>] <span class="op">=</span> bitumen_2010[<span class="st">'Operator'</span>].replace(operators_dict)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Operator'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array(['CNRL', 'Baytex', 'North Peace Energy Corp.', 'Penn West', 'Shell',
       'Imperial', 'Devon', 'Connacher Oil And Gas Limited', 'MEG',
       'Statoil Canada Ltd.', 'Cenovus', 'Suncor',
       'Japan Canada Oil Sands Limited', 'Total E&amp;P Joslyn Ltd.',
       'ConocoPhillips', 'Nexen', 'Husky', 'Murphy',
       'Prosper Petroleum Ltd.', 'Action Energy Inc.', 'Bonavista',
       'Watch Resources Ltd.', 'Manitok Exploration Inc.', 'Koch',
       'Twin Butte Energy Ltd.', 'Sunshine Oilsands Ltd.',
       'Solara Exploration Ltd.', 'Bellatrix Exploration Ltd.',
       'BlackPearl', 'Crispin Energy Inc.', 'Buffalo Resources Corp.',
       'Harvest Operations Corp.', 'Bronco Energy Ltd.',
       'Frog Lake Energy Resources Corp.'], dtype=object)</code></pre>
</div>
</div>
<p>It should be noted that there have been a number of acquisitions and mergers in the oil and gas industry in recent years, and this can lead to inconsistencies in the naming of operators across different years. However, for the sake of simplicity, we will ignore these changes and assume that operator names remain consistent across all years.</p>
</section>
<section id="simplifiying-the-area-column" class="level2">
<h2 class="anchored" data-anchor-id="simplifiying-the-area-column">Simplifiying the Area column</h2>
<p>To simplify the <code>Area</code> column, we can replace the values <code>Peace River Area 1</code> and <code>Peace River Area 2</code> with a single value <code>Peace River</code>. This is done to aggregate the production data for the Peace River area.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Area'</span>] <span class="op">=</span> bitumen_2010[<span class="st">'Area'</span>].replace({<span class="st">'Peace River Area 1'</span>: <span class="st">'Peace River'</span>, <span class="st">'Peace River Area 2'</span>: <span class="st">'Peace River'</span>}) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Area'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array(['Cold Lake', 'Peace River', 'Athabasca, Cold Lake', 'Athabasca'],
      dtype=object)</code></pre>
</div>
</div>
<p>There is only one row with an <code>Area</code> value of <code>Athabasca, Cold Lake</code>. To make it consistent with the other rows, we can change it to <code>Cold Lake</code>.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Area'</span>] <span class="op">=</span> bitumen_2010[<span class="st">'Area'</span>].replace({<span class="st">'Athabasca, Cold Lake'</span>: <span class="st">'Cold Lake'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also add a <code>Year</code> column to the dataframe.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Year'</span>] <span class="op">=</span> <span class="bu">int</span>(xls_files[<span class="dv">0</span>].split(<span class="st">'_'</span>)[<span class="op">-</span><span class="dv">1</span>].split(<span class="st">'-'</span>)[<span class="dv">0</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>bitumen_2010[<span class="st">'Year'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([2010], dtype=int64)</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-a-single-tidy-dataset-for-bitumen-production-for-all-years" class="level1">
<h1>Creating a single tidy dataset for bitumen production for all years</h1>
<p>We can combine all the previous steps to create a function that generates a tidy dataset for the bitumen analysis. The function takes the following arguments:</p>
<ul>
<li><code>df</code>: a dataframe for a given year</li>
<li><code>operators_dict</code>: a dictionary with the names to be replaced and the new names</li>
<li><code>xls_file</code>: the name of the excel file for a given year</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a function to create a tidy dataset for bitumen production</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_tidy_bitumen(df, operators_dict, xls_file):</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    last_row_idx <span class="op">=</span> np.where(df[[<span class="st">"Recovery Method"</span>]] <span class="op">==</span> <span class="st">"Total "</span>)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.iloc[:last_row_idx, :]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (df</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            .drop(columns <span class="op">=</span> [<span class="st">'Monthly Average'</span>])</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>            .dropna(subset <span class="op">=</span> [<span class="st">'Operator'</span>])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            .assign(Operator <span class="op">=</span> <span class="kw">lambda</span> x: x.Operator.<span class="bu">str</span>.split(<span class="st">'('</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip())</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>            .assign(Operator <span class="op">=</span> <span class="kw">lambda</span> x: x.Operator.<span class="bu">str</span>.replace(<span class="st">'  '</span>, <span class="st">' '</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>            .replace({<span class="st">'Operator'</span>: operators_dict})</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>            .assign(Year <span class="op">=</span> <span class="bu">int</span>(xls_file.split(<span class="st">'_'</span>)[<span class="op">-</span><span class="dv">1</span>].split(<span class="st">'-'</span>)[<span class="dv">0</span>]))</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>            .assign(Area <span class="op">=</span> <span class="kw">lambda</span> x: x.Area.replace({<span class="st">'Peace River Area 1'</span>: <span class="st">'Peace River'</span>, <span class="st">'Peace River Area 2'</span>: <span class="st">'Peace River'</span>}))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To generate a tidy dataset for bitumen production for all years, we can use the previously defined function to create tidy datasets for each year and then use a for loop to iterate through all the .xls files. For each year, we generate a tidy dataset using the function and append it to the <code>bitumen</code> dataframe using the <code>df.append()</code> method.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tidy dataset for bitumen production for all years</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>bitumen <span class="op">=</span> pd.DataFrame()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> xls_file <span class="kw">in</span> xls_files:</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_excel(xls_file, sheet_name <span class="op">=</span> <span class="va">None</span>, skiprows <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    bitumen <span class="op">=</span> bitumen.append(create_tidy_bitumen(df[<span class="st">'BITUMEN'</span>], operators_dict, xls_file))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check the <code>Year</code> column to make sure that we have data for all years.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>bitumen[<span class="st">'Year'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([2010, 2011, 2012, 2013, 2014, 2016, 2017, 2018, 2019, 2020, 2021,
       2022], dtype=int64)</code></pre>
</div>
</div>
</section>
<section id="saving-the-dataset" class="level1">
<h1>Saving the dataset</h1>
<p>We save the dataset as a csv file in the current local folder for future use.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bitumen.to_csv(<span class="st">'bitumen.csv'</span>, index <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>