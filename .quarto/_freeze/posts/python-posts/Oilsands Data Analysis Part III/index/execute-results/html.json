{
  "hash": "9a2053fa4058a6e1fcf401464950fe67",
  "result": {
    "markdown": "---\ntitle: Alberta In-situ Oilsands Production Analysis using Python - Part III\nsubtitle: Data analysis and visualization\nauthor: Farshad Tabasinejad\ndate: '2023-03-05'\ntoc: true\ndraft: false\ncategories:\n  - python\n  - data analysis\n  - data visualization\n  - pandas\n  - seaborn\n  - matplotlib\nimage: alberta_production_rates.png\nexecute:\n  cache: false\n  output: true\nformat:\n  html:\n    code-fold: false\n    code-tools: false\n    code-overflow: wrap\n    code-block-bg: true\n    code-block-border-left: '#31BAE9'\n    code-copy: hover\n    highlight: zenburn\n---\n\n# Disclaimer\n\nThis blog post is for educational purposes only. Any commercial use of the information provided in this blog post is prohibited. For more information about the AER copyright and permission to reproduce, please visit [AER Copyright and Disclaimer](https://www.aer.ca/copyright-disclaimer).\nThe author is not responsible for any damage or loss caused by the use of the information provided in this blog post. \n\n# Introduction\n\nAlberta Energy Regulator (AER) lists the monthly injection and production data for all in-situ oilsands projects in Alberta on its website [Alberta Energy Regulator](https://www.aer.ca/). The data is available in several spreadsheets and can be downloaded from [ST53: Alberta In Situ Oil Sands Production Summary](https://www.aer.ca/providing-information/data-and-reports/statistical-reports/st53). The annual data are reported in separate files in **`.xls`** format. Each file has 6 different sheets with information about bitumen, water, steam, wells, SOR, and WSR.\n\nTo learn how to download and prepare the tidy dataset in `.csv` format, please refered to the previous posts [Downloading Alberta Oilsands Production Data using Python]() and [Alberta In-situ Oilsands Production Analysis using Python - Part I](). In this post we use the tidy `bitumen.csv` file for data analysis and visualization.\n\n# Loading the data\n\nAll files are stored in the current local directory. We use the `glob` module to list all `.csv` files in the directory and then use `pandas` to read the data into a `DataFrame`. The `matplotlib` and `seaborn` modules are used to create the plots.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport glob\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n:::\n\n\nThe `glob` module is used to list all `.csv` files in the directory, which we can then read into a DataFrame using pandas. \n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ncsv_files = glob.glob('*.csv')\ncsv_files\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\n['bitumen.csv']\n```\n:::\n:::\n\n\nThe `bitumen.csv` file is loaded into a dataframe using the `read_csv` function from the pandas module.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nbitumen = pd.read_csv(\"bitumen.csv\")\nbitumen.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Operator</th>\n      <th>Scheme Name</th>\n      <th>Area</th>\n      <th>Approval Number</th>\n      <th>Recovery Method</th>\n      <th>Jan</th>\n      <th>Feb</th>\n      <th>Mar</th>\n      <th>Apr</th>\n      <th>May</th>\n      <th>Jun</th>\n      <th>Jul</th>\n      <th>Aug</th>\n      <th>Sep</th>\n      <th>Oct</th>\n      <th>Nov</th>\n      <th>Dec</th>\n      <th>Year</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>CNRL</td>\n      <td>NaN</td>\n      <td>Cold Lake</td>\n      <td>4746P</td>\n      <td>Commercial</td>\n      <td>587.48</td>\n      <td>596.72</td>\n      <td>637.59</td>\n      <td>678.74</td>\n      <td>705.61</td>\n      <td>718.99</td>\n      <td>697.25</td>\n      <td>696.88</td>\n      <td>763.21</td>\n      <td>702.21</td>\n      <td>696.32</td>\n      <td>674.99</td>\n      <td>2010</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>CNRL</td>\n      <td>NaN</td>\n      <td>Cold Lake</td>\n      <td>6726I</td>\n      <td>Commercial</td>\n      <td>171.54</td>\n      <td>193.66</td>\n      <td>187.71</td>\n      <td>177.54</td>\n      <td>176.90</td>\n      <td>174.50</td>\n      <td>160.53</td>\n      <td>155.97</td>\n      <td>168.22</td>\n      <td>168.27</td>\n      <td>139.73</td>\n      <td>143.48</td>\n      <td>2010</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Baytex</td>\n      <td>Cliffdale Pilot</td>\n      <td>Peace River</td>\n      <td>11034E</td>\n      <td>Commercial-CSS</td>\n      <td>0.00</td>\n      <td>2.55</td>\n      <td>6.15</td>\n      <td>2.25</td>\n      <td>4.16</td>\n      <td>10.59</td>\n      <td>5.83</td>\n      <td>3.27</td>\n      <td>9.18</td>\n      <td>20.09</td>\n      <td>15.42</td>\n      <td>13.15</td>\n      <td>2010</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>North Peace Energy Corp.</td>\n      <td>Red Earth</td>\n      <td>Peace River</td>\n      <td>11209A</td>\n      <td>Commercial-CSS</td>\n      <td>10.30</td>\n      <td>4.70</td>\n      <td>3.11</td>\n      <td>2.21</td>\n      <td>1.63</td>\n      <td>0.51</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.40</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>2010</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Penn West</td>\n      <td>Seal</td>\n      <td>Peace River</td>\n      <td>11377A</td>\n      <td>Commercial-CSS</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>2010</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# Data analysis and visualization\n\n## Alberta average bitumen production rate per year\n\nThe daily bitumen production rate is reported as a monthly average in m3/day. An approximation of the yearly average production rate in m3/day is calculated by taking the average of the monthly average production rates. The yearly average production rate is then converted to Mm3/day by dividing it by 1,000.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# Calculate the average daily production rate for each year\nbitumen_agg = (bitumen\n              .assign(Production_Rate = lambda x: x.loc[:,\"Jan\":\"Dec\"].mean(axis = 1))\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'])\n              .groupby(['Year'])\n              .sum()\n              .div(1000)\n              .reset_index()\n              )\nbitumen_agg\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Production_Rate</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2010</td>\n      <td>119.596470</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2011</td>\n      <td>134.691030</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2012</td>\n      <td>157.040421</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2013</td>\n      <td>175.839908</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2014</td>\n      <td>200.679804</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>2016</td>\n      <td>220.765067</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>2017</td>\n      <td>245.572865</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2018</td>\n      <td>249.694999</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2019</td>\n      <td>245.745934</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>2020</td>\n      <td>237.340961</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2021</td>\n      <td>264.391272</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2022</td>\n      <td>269.899715</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nLet's see the yearly average production rate in Mm3/day.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n# Plot the yearly average production rate\nplt.figure(figsize = (8, 6))\nsns.barplot(x = 'Year', y = 'Production_Rate', data = bitumen_agg)\nplt.title('Alberta average bitumen production rate')\nplt.xlabel('Year')\nplt.ylabel('Production Rate (Mm3/day)')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=668 height=515}\n:::\n:::\n\n\n## Largest bitumen producers in Alberta since 2010\n\nThe top 10 largest bitumen producers in Alberta since 2010 are listed below. The data is sorted by the total bitumen production in descending order. The total bitumen production rate is converted to MMm3/day by dividing by 1,000,000.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# Calculate the total bitumen production rate for each operator\nbitumen_agg = (bitumen\n              .assign(Cumulative_Production = lambda x: x.loc[:,\"Jan\":\"Dec\"].sum(axis = 1) * 365)\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Year'])\n              .groupby(['Operator'])\n              .sum()\n              .div(1_000_000)\n              .sort_values(by = 'Cumulative_Production', ascending = False)\n              .reset_index()\n              .head(10)\n              )\nbitumen_agg \n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Operator</th>\n      <th>Cumulative_Production</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Cenovus</td>\n      <td>2561.630674</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>CNRL</td>\n      <td>2266.675729</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Suncor</td>\n      <td>1550.949426</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Imperial</td>\n      <td>1249.998787</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ConocoPhillips</td>\n      <td>668.101066</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Devon</td>\n      <td>533.488187</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MEG</td>\n      <td>531.186018</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Husky</td>\n      <td>359.571866</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Nexen</td>\n      <td>157.297422</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>CNOOC</td>\n      <td>146.821801</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe figure below illustrates the top 10 largest bitumen producers in Alberta since 2010.\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n# Plot the top 10 largest bitumen producers in Alberta since 2010\nplt.figure(figsize = (8, 6))\nsns.barplot(x = 'Cumulative_Production', y = 'Operator', data = bitumen_agg)\nplt.title('Top 10 largest bitumen producers in Alberta since 2010')\nplt.xlabel('Cumulative Production (MMm3)')\nplt.ylabel('Operator')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-8-output-1.png){width=738 height=515}\n:::\n:::\n\n\n## Largest bitumen producers in Alberta in 2022\n\nThe top 10 largest bitumen producers in Alberta in 2022 are listed below. The data is sorted by the bitumen production rate in descending order. The yearly bitumen production rate is converted to Mm3/day by dividing by 1,000.\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n# Calculate the yearly bitumen production rate for each operator\nbitumen_agg = (bitumen\n              .query(\"Year == 2022\")\n              .assign(Production_Rate = lambda x: x.loc[:,\"Jan\":\"Dec\"].mean(axis = 1))\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Year'])\n              .groupby(['Operator'])\n              .sum()\n              .div(1000)\n              .sort_values(by = 'Production_Rate', ascending = False)\n              .reset_index()\n              .head(10)\n              )\nbitumen_agg\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Operator</th>\n      <th>Production_Rate</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Cenovus</td>\n      <td>76.725747</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>CNRL</td>\n      <td>55.968093</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Suncor</td>\n      <td>36.721742</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Imperial</td>\n      <td>23.121582</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ConocoPhillips</td>\n      <td>22.142553</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MEG</td>\n      <td>14.758539</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Strathcona</td>\n      <td>7.995144</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>CNOOC</td>\n      <td>7.562969</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Athabasca Oil</td>\n      <td>4.610921</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Greenfire</td>\n      <td>4.151495</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe top 10 largest bitumen producers in Alberta in 2022 are shown in the plot below.\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n# Plot the top 10 largest bitumen producers in Alberta in 2022\nplt.figure(figsize = (8, 6))\nsns.barplot(x = 'Production_Rate', y = 'Operator', data = bitumen_agg)\nplt.title('Top 10 largest bitumen producers in Alberta in 2022')\nplt.xlabel('Production Rate (Mm3/day)')\nplt.ylabel('Operator')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-10-output-1.png){width=742 height=515}\n:::\n:::\n\n\n## Largest bitumen producers in Alberta in 2022 by area\n\nThe top 5 largest 2022 bitumen producers by area in Alberta are listed below. The data is sorted by the bitumen production rate in descending order. The yearly bitumen production rate is converted to Mm3/day by dividing by 1,000.\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n# Calculate the yearly bitumen production rate for each operator by area\nbitumen_agg = (bitumen\n              .query(\"Year == 2022\")\n              .assign(Production_Rate = lambda x: x.loc[:,\"Jan\":\"Dec\"].mean(axis = 1))\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Year'])\n              .groupby(['Area', 'Operator'])\n              .sum()\n              .div(1000)\n              .sort_values(by = 'Production_Rate', ascending = False)\n              .groupby('Area')\n              .head(5)\n              .reset_index()\n              )\nbitumen_agg\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Area</th>\n      <th>Operator</th>\n      <th>Production_Rate</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Athabasca</td>\n      <td>Cenovus</td>\n      <td>76.565583</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Athabasca</td>\n      <td>CNRL</td>\n      <td>36.756985</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Athabasca</td>\n      <td>Suncor</td>\n      <td>36.721742</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Cold Lake</td>\n      <td>Imperial</td>\n      <td>23.121582</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Athabasca</td>\n      <td>ConocoPhillips</td>\n      <td>22.142553</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Cold Lake</td>\n      <td>CNRL</td>\n      <td>17.712652</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Athabasca</td>\n      <td>MEG</td>\n      <td>14.758539</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Cold Lake</td>\n      <td>Strathcona</td>\n      <td>7.995144</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Peace River</td>\n      <td>Baytex</td>\n      <td>2.889908</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Peace River</td>\n      <td>CNRL</td>\n      <td>1.498456</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Peace River</td>\n      <td>Obsidian</td>\n      <td>0.889067</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Cold Lake</td>\n      <td>Baytex</td>\n      <td>0.308280</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Peace River</td>\n      <td>Islander</td>\n      <td>0.273017</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Cold Lake</td>\n      <td>Cenovus</td>\n      <td>0.160163</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Peace River</td>\n      <td>Woodcote</td>\n      <td>0.031730</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe figure below shows the top 5 largest bitumen producers in Alberta in 2022 by area.\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nfig, ax = plt.subplots(3, 1, figsize = (6, 15))\nfor i, area in enumerate(bitumen_agg['Area'].unique()):\n    sns.barplot(x = 'Production_Rate', y = 'Operator', data = bitumen_agg.query(\"Area == @area\"), ax = ax[i])\n    ax[i].set_title(area)\n    ax[i].set_xlabel('Production Rate (Mm3/day)')\n    ax[i].set_ylabel('Operator')\nfig.subplots_adjust(top = 0.95)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-1.png){width=596 height=1268}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}