{"title":"Alberta In-situ Oilsands Production Analysis using Python - Part III","markdown":{"yaml":{"title":"Alberta In-situ Oilsands Production Analysis using Python - Part III","subtitle":"Data analysis and visualization","author":"Farshad Tabasinejad","date":"2023-03-05","toc":true,"draft":false,"categories":["python","data analysis","data visualization","pandas","seaborn","matplotlib"],"image":"alberta_production_rates.png","execute":{"cache":false,"output":true},"format":{"html":{"code-fold":false,"code-tools":false,"code-overflow":"wrap","code-block-bg":true,"code-block-border-left":"#31BAE9","code-copy":"hover","highlight":"zenburn"}},"jupyter":"python3"},"headingText":"Disclaimer","containsRefs":false,"markdown":"\n\n\nThis blog post is for educational purposes only. Any commercial use of the information provided in this blog post is prohibited. For more information about the AER copyright and permission to reproduce, please visit [AER Copyright and Disclaimer](https://www.aer.ca/copyright-disclaimer).\nThe author is not responsible for any damage or loss caused by the use of the information provided in this blog post. \n\n# Introduction\n\nAlberta Energy Regulator (AER) lists the monthly injection and production data for all in-situ oilsands projects in Alberta on its website [Alberta Energy Regulator](https://www.aer.ca/). The data is available in several spreadsheets and can be downloaded from [ST53: Alberta In Situ Oil Sands Production Summary](https://www.aer.ca/providing-information/data-and-reports/statistical-reports/st53). The annual data are reported in separate files in **`.xls`** format. Each file has 6 different sheets with information about bitumen, water, steam, wells, SOR, and WSR.\n\nTo learn how to download and prepare the tidy dataset in `.csv` format, please refered to the previous posts [Downloading Alberta Oilsands Production Data using Python]() and [Alberta In-situ Oilsands Production Analysis using Python - Part I](). In this post we use the tidy `bitumen.csv` file for data analysis and visualization.\n\n# Loading the data\n\nAll files are stored in the current local directory. We use the `glob` module to list all `.csv` files in the directory and then use `pandas` to read the data into a `DataFrame`. The `matplotlib` and `seaborn` modules are used to create the plots.\n\n\n```{python}\nimport glob\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n\nThe `glob` module is used to list all `.csv` files in the directory, which we can then read into a DataFrame using pandas. \n\n```{python}\ncsv_files = glob.glob('*.csv')\ncsv_files\n```\n\nThe `bitumen.csv` file is loaded into a dataframe using the `read_csv` function from the pandas module.\n\n```{python}\nbitumen = pd.read_csv(\"bitumen.csv\")\nbitumen.head()\n```\n\n# Data analysis and visualization\n\n## Alberta average bitumen production rate per year\n\nThe daily bitumen production rate is reported as a monthly average in m3/day. An approximation of the yearly average production rate in m3/day is calculated by taking the average of the monthly average production rates. The yearly average production rate is then converted to Mm3/day by dividing it by 1,000.\n\n```{python}\n# Calculate the average daily production rate for each year\nbitumen_agg = (bitumen\n              .assign(Production_Rate = lambda x: x.loc[:,\"Jan\":\"Dec\"].mean(axis = 1))\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'])\n              .groupby(['Year'])\n              .sum()\n              .div(1000)\n              .reset_index()\n              )\nbitumen_agg\n```\n\nLet's see the yearly average production rate in Mm3/day.\n\n```{python}\n# Plot the yearly average production rate\nplt.figure(figsize = (8, 6))\nsns.barplot(x = 'Year', y = 'Production_Rate', data = bitumen_agg)\nplt.title('Alberta average bitumen production rate')\nplt.xlabel('Year')\nplt.ylabel('Production Rate (Mm3/day)')\nplt.show()\n```\n\n## Largest bitumen producers in Alberta since 2010\n\nThe top 10 largest bitumen producers in Alberta since 2010 are listed below. The data is sorted by the total bitumen production in descending order. The total bitumen production rate is converted to MMm3/day by dividing by 1,000,000.\n\n```{python}\n# Calculate the total bitumen production rate for each operator\nbitumen_agg = (bitumen\n              .assign(Cumulative_Production = lambda x: x.loc[:,\"Jan\":\"Dec\"].sum(axis = 1) * 365)\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Year'])\n              .groupby(['Operator'])\n              .sum()\n              .div(1_000_000)\n              .sort_values(by = 'Cumulative_Production', ascending = False)\n              .reset_index()\n              .head(10)\n              )\nbitumen_agg \n```\n\nThe figure below illustrates the top 10 largest bitumen producers in Alberta since 2010.\n\n```{python}\n# Plot the top 10 largest bitumen producers in Alberta since 2010\nplt.figure(figsize = (8, 6))\nsns.barplot(x = 'Cumulative_Production', y = 'Operator', data = bitumen_agg)\nplt.title('Top 10 largest bitumen producers in Alberta since 2010')\nplt.xlabel('Cumulative Production (MMm3)')\nplt.ylabel('Operator')\nplt.show()\n```\n\n## Largest bitumen producers in Alberta in 2022\n\nThe top 10 largest bitumen producers in Alberta in 2022 are listed below. The data is sorted by the bitumen production rate in descending order. The yearly bitumen production rate is converted to Mm3/day by dividing by 1,000.\n\n```{python}\n# Calculate the yearly bitumen production rate for each operator\nbitumen_agg = (bitumen\n              .query(\"Year == 2022\")\n              .assign(Production_Rate = lambda x: x.loc[:,\"Jan\":\"Dec\"].mean(axis = 1))\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Year'])\n              .groupby(['Operator'])\n              .sum()\n              .div(1000)\n              .sort_values(by = 'Production_Rate', ascending = False)\n              .reset_index()\n              .head(10)\n              )\nbitumen_agg\n```\n\nThe top 10 largest bitumen producers in Alberta in 2022 are shown in the plot below.\n\n```{python}\n# Plot the top 10 largest bitumen producers in Alberta in 2022\nplt.figure(figsize = (8, 6))\nsns.barplot(x = 'Production_Rate', y = 'Operator', data = bitumen_agg)\nplt.title('Top 10 largest bitumen producers in Alberta in 2022')\nplt.xlabel('Production Rate (Mm3/day)')\nplt.ylabel('Operator')\nplt.show()\n```\n\n## Largest bitumen producers in Alberta in 2022 by area\n\nThe top 5 largest 2022 bitumen producers by area in Alberta are listed below. The data is sorted by the bitumen production rate in descending order. The yearly bitumen production rate is converted to Mm3/day by dividing by 1,000.\n\n```{python}\n# Calculate the yearly bitumen production rate for each operator by area\nbitumen_agg = (bitumen\n              .query(\"Year == 2022\")\n              .assign(Production_Rate = lambda x: x.loc[:,\"Jan\":\"Dec\"].mean(axis = 1))\n              .drop(columns = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Year'])\n              .groupby(['Area', 'Operator'])\n              .sum()\n              .div(1000)\n              .sort_values(by = 'Production_Rate', ascending = False)\n              .groupby('Area')\n              .head(5)\n              .reset_index()\n              )\nbitumen_agg\n```\n\nThe figure below shows the top 5 largest bitumen producers in Alberta in 2022 by area.\n\n```{python}\nfig, ax = plt.subplots(3, 1, figsize = (6, 15))\nfor i, area in enumerate(bitumen_agg['Area'].unique()):\n    sns.barplot(x = 'Production_Rate', y = 'Operator', data = bitumen_agg.query(\"Area == @area\"), ax = ax[i])\n    ax[i].set_title(area)\n    ax[i].set_xlabel('Production Rate (Mm3/day)')\n    ax[i].set_ylabel('Operator')\nfig.subplots_adjust(top = 0.95)\nplt.show()\n```"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":false,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":{"light":["Yeti","../../../theme.scss"]},"title-block-banner":false,"title":"Alberta In-situ Oilsands Production Analysis using Python - Part III","subtitle":"Data analysis and visualization","author":"Farshad Tabasinejad","date":"2023-03-05","draft":false,"categories":["python","data analysis","data visualization","pandas","seaborn","matplotlib"],"image":"alberta_production_rates.png","jupyter":"python3","code-block-bg":true,"code-block-border-left":"#31BAE9","code-copy":"hover","highlight":"zenburn"},"extensions":{"book":{"multiFile":true}}}}}