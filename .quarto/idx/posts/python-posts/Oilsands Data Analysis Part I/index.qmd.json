{"title":"Alberta In-situ Oilsands Production Analysis using Python - Part I","markdown":{"yaml":{"title":"Alberta In-situ Oilsands Production Analysis using Python - Part I","subtitle":"Data extraction from AER website","author":"Farshad Tabasinejad","date":"2023-02-26","toc":true,"draft":false,"categories":["python","web scraping"],"image":"Oilsands_monthly_production_2010.png","execute":{"cache":false,"output":true},"format":{"html":{"code-fold":false,"code-tools":false,"code-overflow":"wrap","code-block-bg":true,"code-block-border-left":"#31BAE9","code-copy":"hover","highlight":"zenburn"}},"jupyter":"python3"},"headingText":"Disclaimer","containsRefs":false,"markdown":"\n\n\nThe information provided in this blog post is for educational purposes only. Commercial use of this information is prohibited. For information on the copyright and permission to reproduce, please visit the AER Copyright and Disclaimer page at [AER Copyright and Disclaimer](https://www.aer.ca/copyright-disclaimer).\n\nThe author assumes no responsibility for any damage or loss resulting from the use of the information provided in this blog post.\n\n# Introduction\n\nThe Alberta Energy Regulator (AER) provides monthly injection and production data for all in-situ oilsands projects in Alberta on its website at [Alberta Energy Regulator](https://www.aer.ca/). The data is available in several spreadsheets and can be downloaded from the [ST53: Alberta In Situ Oil Sands Production Summary](https://www.aer.ca/providing-information/data-and-reports/statistical-reports/st53). The annual data is reported in separate files in **`.xls`** format. Each file contains six different sheets with information about bitumen, water, steam, wells, SOR, and WSR.\n\n# Downloading the data\n\nTo download the data using Python, the `requests` and `BeautifulSoup` libraries are used. The following code downloads all the .xls files from the AER website and saves them in the current directory:\n\n```{python}\nimport requests\nfrom bs4 import BeautifulSoup\n# get the html\nurl = 'https://www.aer.ca/providing-information/data-and-reports/statistical-reports/st53'\nr = requests.get(url)\ndata = r.text\n# parse the html\nsoup = BeautifulSoup(data, 'html.parser')\n# find all the hyperlinks\nlinks = soup.findAll('a', href = True) \n# get the list of xls files only\nxls_links = [link for link in links if link.get('href').endswith('xls')]\n# download the xls files and save them in the current directory\nfor link in xls_links:\n    xls_url = link.get('href')\n    xls_name = xls_url.split('/')[-1]\n    xls = requests.get(xls_url)\n    with open(xls_name, 'wb') as f:\n        f.write(xls.content)\n```\n\n## Listing all the saved xls files\n\n```{python}\nimport os\n# filter only .xls files\nxls_files = [file for file in os.listdir(os.getcwd()) if file.endswith('.xls')]\nxls_files\n```\n\nIn the next post, I will show how to read the data from the .xls files and prepare the datasets for further analysis. This analysis will provide insights into the production trends and patterns of in-situ oilsands projects in Alberta."},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":false,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":{"light":["Yeti","../../../theme.scss"]},"title-block-banner":false,"title":"Alberta In-situ Oilsands Production Analysis using Python - Part I","subtitle":"Data extraction from AER website","author":"Farshad Tabasinejad","date":"2023-02-26","draft":false,"categories":["python","web scraping"],"image":"Oilsands_monthly_production_2010.png","jupyter":"python3","code-block-bg":true,"code-block-border-left":"#31BAE9","code-copy":"hover","highlight":"zenburn"},"extensions":{"book":{"multiFile":true}}}}}